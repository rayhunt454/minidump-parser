
# MiniDump Parser - ะธะฝััััะผะตะฝั ะฐะฝะฐะปะธะทะฐ ะผะธะฝะธ-ะดะฐะผะฟะพะฒ ะฟัะพัะตััะพะฒ ะดะปั DFIR

ะะฝััััะผะตะฝั ะบะพะผะฐะฝะดะฝะพะน ัััะพะบะธ ะดะปั ะฐะฝะฐะปะธะทะฐ ะผะธะฝะธะดะฐะผะฟะพะฒ Windows ั ะธะทะฒะปะตัะตะฝะธะตะผ ะบัะธะผะธะฝะฐะปะธััะธัะตัะบะธ ะทะฝะฐัะธะผะพะน ะธะฝัะพัะผะฐัะธะธ.

# ๐ ะัะฝะพะฒะฝัะต ะฒะพะทะผะพะถะฝะพััะธ

## ๐ ะะฝะฐะปะธะท ะธะฝัะพัะผะฐัะธะธ ะพ ะฟัะพัะตััะต

* ะะทะฒะปะตัะตะฝะธะต PID ะฟัะพัะตััะฐ
* ะัะตะผั ัะพะทะดะฐะฝะธั ะธ ะฒัะตะผั ัะฐะฑะพัั ะฟัะพัะตััะฐ
* ะัะตะผั CPU (ะฟะพะปัะทะพะฒะฐัะตะปััะบะพะต ะธ ัะธััะตะผะฝะพะต)

## ๐ฆ ะะทะฒะปะตัะตะฝะธะต ะผะพะดัะปะตะน

* ะะฑะฝะฐััะถะตะฝะธะต ะฒัะตั ะทะฐะณััะถะตะฝะฝัั DLL ะธ EXE ัะฐะนะปะพะฒ
* ะะทะฒะปะตัะตะฝะธะต ะผะตัะฐะดะฐะฝะฝัั ะผะพะดัะปะตะน (ะฑะฐะทะพะฒัะน ะฐะดัะตั, ัะฐะทะผะตั, ะฒัะตะผะตะฝะฝะฐั ะผะตัะบะฐ)
* ะะฐะผะฟ ะผะพะดัะปะตะน ะฒ ัะฐะนะปั ะดะปั ะดะฐะปัะฝะตะนัะตะณะพ ะฐะฝะฐะปะธะทะฐ

## ๐ ะะฝะฐะปะธะท ะพัะบััััั ััะฝะดะปะพะฒ ะฟัะพัะตััะฐ

* ะะฑะฝะฐััะถะตะฝะธะต ะพัะบััััั ัะฐะนะปะพะฒ, ะบะปััะตะน ัะตะตัััะฐ, ะผัััะตะบัะพะฒ
* ะะฝัะพัะผะฐัะธั ะพ ัะธะฟะฐั ะธ ัะพััะพัะฝะธัั ััะฝะดะปะพะฒ

## ๐ ะะพะธัะบ ัะตัะตะฒัั ะฐััะตัะฐะบัะพะฒ

* ะะพะธัะบ URL, ะดะพะผะตะฝะพะฒ ะธ IP-ะฐะดัะตัะพะฒ ะฒ ะฟะฐะผััะธ ะฟัะพัะตััะฐ
* ะะฐะปะธะดะฐัะธั ะธ ะพัะธััะบะฐ ะฝะฐะนะดะตะฝะฝัั ะฐััะตัะฐะบัะพะฒ  

## ๐พ ะกะพััะฐะฝะตะฝะธะต ัะตะทัะปััะฐัะพะฒ

* ะญะบัะฟะพัั ะฒัะตะน ัะพะฑัะฐะฝะฝะพะน ะธะฝัะพัะผะฐัะธะธ ะฒ JSON ัะพัะผะฐั
* ะกัััะบัััะธัะพะฒะฐะฝะฝัะน JSON-ะพััะตั ะดะปั ะดะฐะปัะฝะตะนัะตะณะพ ะฐะฝะฐะปะธะทะฐ ะธะปะธ ะทะฐะณััะทะบะธ ะฒ ELK

# ๐ ะฃััะฐะฝะพะฒะบะฐ

```bash

git clone <repository-url>
cd minidump-parser

pip install -r requirements.txt
```

# ๐ ะัะฟะพะปัะทะพะฒะฐะฝะธะต

ะะฐะทะพะฒัะน ะฐะฝะฐะปะธะท ั ัะพััะฐะฝะตะฝะธะตะผ ะพััะตัะฐ

```bash
python main.py -f dumpfile.dmp -o report.json
```

ะะพะปะฝัะน ะฐะฝะฐะปะธะท ั ะดะฐะผะฟะพะผ ะผะพะดัะปะตะน

```bash
python main.py -f dumpfile.dmp -o report.json -dump true -dump-dir ./extracted_modules
```

ะะฐัะฐะผะตััั ะบะพะผะฐะฝะดะฝะพะน ัััะพะบะธ

```
usage: main.py [-h] [-f DUMP_FILE] [-o OUTPUT] [-dump DUMP] [-dump-dir DUMP_DIR]

Mini-dump parser for DFIR

options:
  -h, --help            show this help message and exit
  -f, --dump-file DUMP_FILE Mini dump file (.dmp)
  -o, --output OUTPUT   File for saving a JSON report
  -dump DUMP            Flag to dump all DLL/EXE from mini-dump
  -dump-dir DUMP_DIR    Path to save all DLL/EXE modules
```

# ๐ ะกัััะบัััะฐ ะพััะตัะฐ

ะััะตั ัะพััะฐะฝัะตััั ะฒ JSON ัะพัะผะฐัะต ัะพ ัะปะตะดัััะตะน ััััะบัััะพะน:

```json
{
  "TimeLine": "2024-01-16T12:00:00", // ะัะตะผะตะฝะฝะฐั ะผะตัะบะฐ ัะพะทะดะฐะฝะธั ะผะธะฝะธ-ะดะฐะผะฟะฐ
  "FilePath": "path/to/dump.dmp", // ะััั ะบ ัะฐะนะปั ะผะธะฝะธะดะฐะผะฟะฐ
  "Process": { // ะะฝัะพัะผะฐัะธั ะพ ะฟัะพัะตััะต
    "Pid": 1234,
    "CreateTime": "2024-01-16T11:30:00",
    "Uptime": "00:30:00",
    "UserTime": "00:01:23",
    "KernelTime": "00:00:45"
  },
  "Modules": [ // ะะฝัะพัะผะฐัะธั ะพ ะทะฐะณััะถะตะฝะฝัั DLL/EXE
    {
      "Name": "kernel32.dll",
      "BaseAddress": "0x7FFD0000",
      "Size": 2048000,
      "Type": "DLL",
      "TimeStamp": "2024-01-01T00:00:00"
      "Version": {
ย ย ย ย "FileVersion": "10.0.18362.329",
ย ย ย ย "ProductVersion": "10.0.18362.329",
ย ย ย ย "FileType": "Unknown (0x00040004)",
ย ย ย ย "Signature": 4277077181,
ย ย ย ย "IsValid": true
ย ย ย }
    }
  ],
  "Handles": [ // ะะฝัะพัะผะฐัะธั ะพะฑ ะพัะบััััั ัะตะฝะดะปะฐั ะฟัะพัะตััะฐ
    {
ย ย ย "Handle": "0x98",
ย ย ย "Type": "Key",
ย ย ย "ObjectName": "\\REGISTRY\\MACHINE",
ย ย ย "AccessRight": [
ย ย ย ย "KEY_QUERY_VALUE",
ย ย ย ย "KEY_SET_VALUE",
ย ย ย ย "KEY_CREATE_SUB_KEY",
ย ย ย ย "KEY_ENUMERATE_SUB_KEYS",
ย ย ย ย "KEY_ALL_ACCESS"
ย ย ย ],
ย ย ย "PointCount": 65531
ย ย }
  ],
  "Artifacts": { // ะะฐะนะดะตะฝะฝัะต ัััะพะบะธ ะฟะพ ัะตะณัะปััะฝัะผ ะฒััะฐะถะตะฝะธั
    "urls": [],
    "domains": [],
    "ip_addresses": []
  }
}
```

# ๐ ะกัััะบัััะฐ ะฟัะพะตะบัะฐ

```text
minidump-parser/
โโโ minidump
  โโโ minidump_parser.py ย ย # ะะฐััะตั ะทะฐะณะพะปะพะฒะบะฐ ะผะธะฝะธะดะฐะผะฟะฐ
  โโโ process_parser.py ย ย ย# ะะทะฒะปะตัะตะฝะธะต ะธะฝัะพัะผะฐัะธะธ ะพ ะฟัะพัะตััะต
  โโโ module_parser.py ย ย ย # ะะฐััะธะฝะณ ะผะพะดัะปะตะน
  โโโ handle_parser.py ย ย ย # ะะฝะฐะปะธะท ััะฝะดะปะพะฒ
  โโโ artifacts.py ย ย ย ย ย # ะะพะธัะบ ะฐััะตัะฐะบัะพะฒ
โโโ main.py ย ย ย ย ย ย ย# ะัะฝะพะฒะฝะพะน ัะบัะธะฟั
โโโ requirements.txt ย ย # ะะฐะฒะธัะธะผะพััะธ
โโโ README.md ย ย ย ย ย # ะะพะบัะผะตะฝัะฐัะธั  
```



# โ๏ธ ะะธัะตะฝะทะธั

ะญัะพั ะฟัะพะตะบั ะปะธัะตะฝะทะธัะพะฒะฐะฝ ะฟะพะด MIT License - ัะผ. ัะฐะนะป LICENSE ะดะปั ะดะตัะฐะปะตะน.
